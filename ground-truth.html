<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title></title>
        <script type="text/javascript" src="js/semantic-cluster.js"></script>
        <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
        <link rel="stylesheet" href="css/semantic-cluster.css" type="text/css">
        <link rel="stylesheet" href="css/ground-truth.css" type="text/css">
    </head>
    
    <body style="background-color: #B2D6E9">
        <div>
            Select a topic:
            <select id = "topicSelect" onchange="topicSelection()">
                <option></option>
                <option value="03">3.Haiti Aristide return</option>
                <option value="21">21.Emanuel residency court rulings</option>
                <option value="22">22.healthcare law unconstitutional</option>
                <option value="26">26.US unemployment</option>
                <option value="42">42.Holland Iran envoy recall</option>
                <option value="51">51.British Government cuts</option>
                <option value="57">57.Chicago blizzard</option>
                <option value="66">66.Journalists' treatment in Egypt</option>
                <option value="68">68.Charlie Sheen rehab</option>
                <option value="88">88.Kings' Speech awards</option>
            </select>
        </div>
        <div id="main"></div>
        
        <script type="text/javascript">
            var tweetsPath = "data/relevant-chrono-sort-tweets/json/";
            var clustersPath = "data/semantic-clusters/json/";
            
            function topicSelection() {
                document.getElementById("main").style.display = "";
                choices = document.getElementById("topicSelect");
                topicNum = choices[choices.selectedIndex].value;
                var tweets = {};
                $.ajax({
                    url: tweetsPath + "tweet_topic" + topicNum + ".json",
                    dataType: "text",
                    async: false,
                    success: function(json) {
                        var data = $.parseJSON(json);
                        for (var i = 0, tweet; i < data.tweets.length; i++) {
                            tweet = data.tweets[i];
                            tweets[tweet.id] = [tweet.time, tweet.name, tweet.screenname, tweet.text];
                        }
                    }
                });
                var items = [];
                var clustersUrl = clustersPath + "topic0" + topicNum + ".json";
                $.ajax({
                    url: clustersUrl,
                    dataType: "text",
                    async: false,
                    success: function(json) {
                        var data = $.parseJSON(json);
                        var clusters = data.clusters;
                        for (var i = 0; i < clusters.length; i ++) {
                            var tweet = tweets[clusters[i][0]];
                            items.push("<div class='tweet'>");
                            items.push("<font><b>" + tweet[1] + "</b></font>&nbsp;");
                            items.push("<font class='gray'>@" + tweet[2] + "</font>");
                            items.push("<div class='text'>" + tweet[3] + "</div>");
                            items.push("<font class='gray'>" + timeConvert(tweet[0]) + "</font>");
                            items.push("</div>");
                        }
                    }
                });
                $("#main").html(items.join(""));
            }
            
            //Sun Jan 23 15:53:01 +0000 2011 --> 3:53 PM - 23 Jan 2011
            function timeConvert(time) {
                var twelve;
                var hour = parseInt(time.substring(11, 13));
                var minute = time.substring(14, 16);
                if (hour == 12) {
                    twelve = "12:" + minute + " PM";
                } else if ( hour > 12) {
                    twelve = (hour - 12) + ":" + minute + " PM";
                } else {
                    twelve = hour + ":" + minute + " AM";
                }
                var result = twelve + " - " + time.substring(8, 10) + " " + time.substring(4, 7) + " " + time.substring(26, 30);
                return result;
            }
        </script>
    </body>
</html>